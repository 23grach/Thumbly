<!DOCTYPE html>
<html>
<head>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #ffffff;
      color: #1a1a1a;
      font-size: 14px;
      line-height: 1.5;
      display: flex;
      flex-direction: column;
    }

    .container {
      padding: 20px;
      width: 100%;
      max-width: 360px;
      min-height: 720px;
      display: flex;
      flex-direction: column;
      gap: 20px;
      justify-content: space-between;
    }

    .content-container {
      display: flex;
      flex-direction: column;
      gap: 16px;
      flex: 1;
    }

    .header {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .header h1 {
      font-size: 20px;
      font-weight: 600;
      color: #1a1a1a;
      margin: 0;
      display: flex;
      align-items: center;
      gap: 8px;
      letter-spacing: -0.02em;
    }

    .header .app-icon {
      font-size: 20px;
    }

    .header p {
      font-size: 13px;
      color: #666666;
      margin: 0;
    }

    .form-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .form-label {
      font-size: 11px;
      font-weight: 600;
      color: #666666;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin: 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .form-input {
      padding: 10px 12px;
      border: 1px solid #e0e0e0;
      border-radius: 6px;
      font-size: 13px;
      background: #ffffff;
      transition: all 0.15s ease;
      font-family: inherit;
      line-height: 1.4;
    }

    .form-input:focus {
      outline: none;
      border-color: #007AFF;
      box-shadow: 0 0 0 2px rgba(0, 122, 255, 0.2);
    }

    .form-input::placeholder {
      color: #999999;
    }

    .textarea {
      resize: none;
      min-height: 60px;
      font-family: inherit;
    }

    .char-counter {
      font-size: 11px;
      color: #999999;
      font-weight: normal;
      text-transform: none;
      letter-spacing: normal;
    }

    .emoji-section {
      background: #f8f8f8;
      border: 1px solid #f0f0f0;
      border-radius: 6px;
      padding: 12px;
    }

    .emoji-grid {
      display: grid;
      grid-template-columns: repeat(8, 1fr);
      gap: 6px;
      margin-top: 8px;
      max-height: 120px;
      overflow-y: auto;
      overflow-x: hidden;
    }

    /* Custom scrollbar for emoji grid */
    .emoji-grid::-webkit-scrollbar {
      width: 6px;
    }

    .emoji-grid::-webkit-scrollbar-track {
      background: #f8f8f8;
      border-radius: 3px;
    }

    .emoji-grid::-webkit-scrollbar-thumb {
      background: #d1d5db;
      border-radius: 3px;
      transition: background-color 0.2s ease;
    }

    .emoji-grid::-webkit-scrollbar-thumb:hover {
      background: #9ca3af;
    }

    .emoji-grid::-webkit-scrollbar-thumb:active {
      background: #6b7280;
    }

    .emoji-item {
      width: 36px;
      height: 36px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      cursor: pointer;
      border-radius: 4px;
      transition: all 0.15s ease;
      border: 1px solid transparent;
      background: #ffffff;
      flex-shrink: 0;
    }

    .emoji-item:hover {
      background: #f0f0f0;
      border-color: #e0e0e0;
      transform: scale(1.05);
    }

    .emoji-item.selected {
      background: #007AFF;
      border-color: #007AFF;
      transform: scale(1.05);
    }

    .theme-toggle {
      display: flex;
      background: #f8f8f8;
      border: 1px solid #e0e0e0;
      border-radius: 6px;
      overflow: hidden;
      margin-top: 4px;
    }

    .theme-option {
      flex: 1;
      padding: 10px 12px;
      background: none;
      border: none;
      cursor: pointer;
      font-size: 13px;
      font-weight: 500;
      transition: all 0.15s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      color: #1a1a1a;
    }

    .theme-option.active {
      background: #007AFF;
      color: white;
    }

    .theme-option:not(.active):hover {
      background: #f0f0f0;
    }

    .actions-container {
      display: flex;
      flex-direction: column;
      width: 100%;
      gap: 8px;
      border-top: 1px solid #f0f0f0;
      padding-top: 16px;
    }

    .btn {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 6px;
      width: 100%;
      padding: 10px 16px;
      border: 1px solid #e0e0e0;
      border-radius: 6px;
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.15s ease;
      background: #ffffff;
      color: #1a1a1a;
      font-family: inherit;
    }

    .btn:hover:not(:disabled) {
      background: #f8f8f8;
      border-color: #d0d0d0;
    }

    .btn-primary {
      background: #007AFF;
      color: white;
      border-color: #007AFF;
    }

    .btn-primary:hover:not(:disabled) {
      background: #0056CC;
      border-color: #0056CC;
    }

    .btn:disabled {
      opacity: 0.4;
      cursor: not-allowed;
      background: #f5f5f5;
      color: #999999;
      border-color: #e0e0e0;
    }

    .btn:disabled:hover {
      background: #f5f5f5;
      border-color: #e0e0e0;
    }

    .required {
      color: #FF3B30;
    }

    .component-tag {
      background: #E8F5E8;
      color: #2E7B32;
      padding: 2px 6px;
      border-radius: 3px;
      font-size: 10px;
      font-weight: 600;
      text-transform: uppercase;
      display: inline-flex;
      align-items: center;
      margin-right: 6px;
    }

    /* Preview Section Styles */
    .preview-section {
      display: flex;
      flex-direction: column;
      gap: 8px;
      align-items: center;
    }

    .thumbnail-preview {
      width: 280px;
      height: 140px;
      background: #ffffff;
      border-radius: 8px;
      padding: 16px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      position: relative;
      color: #1a1a1a;
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
      transition: all 0.2s ease;
    }

    .thumbnail-preview.dark-theme {
      background: #1e1e1e;
      color: #ffffff;
    }

    .preview-emoji {
      font-size: 28px;
      line-height: 1;
      display: flex;
      align-items: flex-start;
      flex-shrink: 0;
    }

    .preview-content {
      display: flex;
      flex-direction: column;
      gap: 6px;
      flex-shrink: 0;
    }

    .preview-title {
      font-size: 16px;
      font-weight: 600;
      line-height: 1.2;
      color: inherit;
      margin: 0;
      max-height: 38px;
      overflow: hidden;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
    }

    .preview-description {
      font-size: 13px;
      font-weight: 400;
      line-height: 1.3;
      color: inherit;
      opacity: 0.7;
      margin: 0;
      max-height: 34px;
      overflow: hidden;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
    }


  </style>
</head>
<body>
  <div class="container">
    <div class="content-container">
      <div class="header">
        <h1>
          <span class="app-icon">üé®</span>
          Thumbly
        </h1>
        <p>Create beautiful project thumbnails</p>
      </div>

      <!-- Preview Section -->
      <div class="preview-section">
        <div class="thumbnail-preview" id="thumbnail-preview">
          <div class="preview-emoji" id="preview-emoji">üöÄ</div>
          <div class="preview-content">
            <div class="preview-title" id="preview-title">Project Title</div>
            <div class="preview-description" id="preview-description">Enter project description</div>
          </div>
        </div>
      </div>

      <div class="form-group">
        <label class="form-label">
          <span>Title <span class="required">*</span></span>
          <span class="char-counter" id="title-counter">0/20</span>
        </label>
        <input 
          type="text" 
          id="title" 
          class="form-input" 
          placeholder="Enter project title..."
          maxlength="20"
          required
        >
      </div>

      <div class="form-group">
        <label class="form-label">
          <span>Description</span>
          <span class="char-counter" id="description-counter">0/40</span>
        </label>
        <textarea 
          id="description" 
          class="form-input textarea" 
          placeholder="Add a brief description..."
          maxlength="40"
        ></textarea>
      </div>

      <div class="form-group">
        <label class="form-label">
          <span>Project Emoji</span>
        </label>
        <div class="emoji-section">
          <div class="emoji-grid" id="emoji-grid">
            <!-- Emojis will be populated by JavaScript -->
          </div>
        </div>
      </div>

      <div class="form-group">
        <label class="form-label">Theme</label>
        <div class="theme-toggle">
          <button class="theme-option active" data-theme="light">
            ‚òÄÔ∏è Light
          </button>
          <button class="theme-option" data-theme="dark">
            üåô Dark
          </button>
        </div>
      </div>
    </div>

    <div class="actions-container">
      <button class="btn btn-primary" id="create" disabled>
        <span>‚ú®</span>
        Create Thumbnail
      </button>
    </div>
  </div>

  <script>
    /**
     * Emoji collections organized by category
     */
    const EMOJI_CATEGORIES = {
      // Development and Technology
      development: [
        'üíª', 'üñ•Ô∏è', '‚å®Ô∏è', 'üñ±Ô∏è', 'üíæ', 'üíø', 'üì±', '‚åö', 
        'üîå', 'üîã', 'üí°', 'üîß', '‚öôÔ∏è', 'üõ†Ô∏è', 'üî©', '‚ö°'
      ],
      
      // Design and Creative
      design: [
        'üåê', 'üé®', 'üñºÔ∏è', 'üìê', 'üìè', '‚úèÔ∏è', 'üñäÔ∏è', 'üñçÔ∏è',
        'üé≠', 'üñåÔ∏è', 'üì∑', 'üì∏', 'üé¨', 'üéûÔ∏è', 'üìπ', 'üé™'
      ],
      
      // Business and Success
      business: [
        'üöÄ', 'üìà', 'üìä', 'üí∞', 'üíé', 'üèÜ', 'ü•á', '‚≠ê',
        'üéØ', 'üé™', 'üíØ', 'üî•', '‚ö°', 'üí™', 'üëë', 'üåü'
      ],
      
      // Science and Education
      science: [
        'üî¨', 'üß™', 'üß¨', 'üìö', 'üìñ', 'üéì', 'üß†', 'üí≠',
        'üîç', 'üîé', 'üìù', 'üìä', 'üìã', 'üìå', 'üìç', 'üóÇÔ∏è'
      ],
      
      // Communication
      communication: [
        'üì¢', 'üì£', 'üì°', 'üì∫', 'üìª', '‚òéÔ∏è', 'üìû', 'üí¨',
        'üíå', 'üìß', 'üì®', 'üì©', 'üì§', 'üì•', 'üìÆ', 'üó≥Ô∏è'
      ],
      
      // Food and Lifestyle
      lifestyle: [
        'üçï', 'üçî', 'üåÆ', 'üçú', 'üç∞', 'üç™', '‚òï', 'üçµ'
      ],
      
      // Travel and Places
      travel: [
        '‚úàÔ∏è', 'üöó', 'üö¢', 'üè†', 'üè¢', 'üåç', 'üó∫Ô∏è', 'üß≠'
      ],
      
      // Health and Sports
      health: [
        '‚öΩ', 'üèÄ', 'üéæ', '‚õ≥', 'üèãÔ∏è', 'ü§∏', 'üßò', '‚ù§Ô∏è'
      ],
      
      // Music and Entertainment
      entertainment: [
        'üéµ', 'üé∂', 'üé∏', 'üéπ', 'üé§', 'üéß', 'üéÆ', 'üïπÔ∏è'
      ]
    };

    /**
     * Flatten all emoji categories into a single array
     */
    const ALL_EMOJIS = Object.values(EMOJI_CATEGORIES).flat();

    /**
     * Plugin state management
     */
    const pluginState = {
      selectedEmoji: 'üöÄ',
      selectedTheme: 'light',
      isFormValid: false
    };

    /**
     * DOM element references
     */
    const elements = {
      titleInput: null,
      descriptionInput: null,
      createButton: null,
      titleCounter: null,
      descriptionCounter: null,
      emojiGrid: null,
      previewTitle: null,
      previewDescription: null,
      previewEmoji: null,
      thumbnailPreview: null
    };

    /**
     * Initialize DOM element references
     */
    function initializeElements() {
      elements.titleInput = document.getElementById('title');
      elements.descriptionInput = document.getElementById('description');
      elements.createButton = document.getElementById('create');
      elements.titleCounter = document.getElementById('title-counter');
      elements.descriptionCounter = document.getElementById('description-counter');
      elements.emojiGrid = document.getElementById('emoji-grid');
      elements.previewTitle = document.getElementById('preview-title');
      elements.previewDescription = document.getElementById('preview-description');
      elements.previewEmoji = document.getElementById('preview-emoji');
      elements.thumbnailPreview = document.getElementById('thumbnail-preview');
    }

    /**
     * Create and populate emoji grid
     */
    function initializeEmojiGrid() {
      if (!elements.emojiGrid) return;

      elements.emojiGrid.innerHTML = '';
      
      ALL_EMOJIS.forEach((emoji, index) => {
        const emojiElement = createEmojiElement(emoji, index === 0);
        elements.emojiGrid.appendChild(emojiElement);
      });
    }

    /**
     * Create a single emoji element
     */
    function createEmojiElement(emoji, isSelected = false) {
      const emojiElement = document.createElement('div');
      emojiElement.className = `emoji-item ${isSelected ? 'selected' : ''}`;
      emojiElement.textContent = emoji;
      emojiElement.setAttribute('data-emoji', emoji);
      emojiElement.setAttribute('title', `Select ${emoji}`);
      
      emojiElement.addEventListener('click', () => handleEmojiSelection(emoji, emojiElement));
      
      return emojiElement;
    }

    /**
     * Handle emoji selection
     */
    function handleEmojiSelection(emoji, emojiElement) {
      // Remove previous selection
      const previouslySelected = elements.emojiGrid.querySelector('.emoji-item.selected');
      if (previouslySelected) {
        previouslySelected.classList.remove('selected');
      }
      
      // Set new selection
      emojiElement.classList.add('selected');
      pluginState.selectedEmoji = emoji;
      
      // Update preview
      updatePreview();
    }

    /**
     * Initialize theme toggle functionality
     */
    function initializeThemeToggle() {
      const themeOptions = document.querySelectorAll('.theme-option');
      
      themeOptions.forEach(option => {
        option.addEventListener('click', () => handleThemeSelection(option));
      });
    }

    /**
     * Handle theme selection
     */
    function handleThemeSelection(selectedOption) {
      // Remove active class from all options
      document.querySelectorAll('.theme-option').forEach(option => {
        option.classList.remove('active');
      });
      
      // Add active class to selected option
      selectedOption.classList.add('active');
      pluginState.selectedTheme = selectedOption.dataset.theme;
      
      // Update preview
      updatePreview();
    }

    /**
     * Validate form and update UI state
     */
    function validateForm() {
      if (!elements.titleInput || !elements.descriptionInput) return;

      const title = elements.titleInput.value.trim();
      const description = elements.descriptionInput.value.trim();
      
      // Update character counters
      updateCharacterCounters(title, description);
      
      // Validate form
      const isValid = title.length > 0;
      pluginState.isFormValid = isValid;
      
      // Update create button state
      if (elements.createButton) {
        elements.createButton.disabled = !isValid;
      }
      
      // Update preview
      updatePreview();
    }

    /**
     * Update character counters
     */
    function updateCharacterCounters(title, description) {
      if (elements.titleCounter) {
        elements.titleCounter.textContent = `${title.length}/20`;
      }
      
      if (elements.descriptionCounter) {
        elements.descriptionCounter.textContent = `${description.length}/40`;
      }
    }

    /**
     * Update preview thumbnail in real-time
     */
    function updatePreview() {
      if (!elements.previewTitle || !elements.previewDescription || !elements.previewEmoji || !elements.thumbnailPreview) {
        return;
      }

      // Get current form values
      const title = elements.titleInput ? elements.titleInput.value.trim() : '';
      const description = elements.descriptionInput ? elements.descriptionInput.value.trim() : '';

      // Update preview content
      elements.previewTitle.textContent = title || 'Project Title';
      elements.previewDescription.textContent = description || 'Enter project description';
      elements.previewEmoji.textContent = pluginState.selectedEmoji;

      // Update theme
      if (pluginState.selectedTheme === 'dark') {
        elements.thumbnailPreview.classList.add('dark-theme');
      } else {
        elements.thumbnailPreview.classList.remove('dark-theme');
      }
    }

    /**
     * Handle form submission
     */
    function handleFormSubmission() {
      if (!pluginState.isFormValid) return;

      const thumbnailData = {
        title: elements.titleInput.value.trim(),
        description: elements.descriptionInput.value.trim(),
        emoji: pluginState.selectedEmoji,
        theme: pluginState.selectedTheme
      };

      // Send message to plugin
      parent.postMessage({
        pluginMessage: {
          type: 'create-thumbnail',
          data: thumbnailData
        }
      }, '*');
    }

    /**
     * Initialize event listeners
     */
    function initializeEventListeners() {
      if (elements.titleInput) {
        elements.titleInput.addEventListener('input', validateForm);
      }
      
      if (elements.descriptionInput) {
        elements.descriptionInput.addEventListener('input', validateForm);
      }
      
      if (elements.createButton) {
        elements.createButton.addEventListener('click', handleFormSubmission);
      }
    }

    /**
     * Main initialization function
     */
    function initialize() {
      initializeElements();
      initializeEmojiGrid();
      initializeThemeToggle();
      initializeEventListeners();
      validateForm();
      updatePreview();
    }

    // Initialize when DOM is ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initialize);
    } else {
      initialize();
    }
  </script>
</body>
</html>

